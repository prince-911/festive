<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Select Theme</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-size: cover;
            background-position: center;
            min-height: 100vh;
            margin: 0;
            padding: 0;
            transition: background-image 0.5s ease-in-out;
        }

        .form-container {
            max-width: 400px;
            margin: 100px auto;
            background: rgba(255, 255, 255, 0.9);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        h2 {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin: 0.5rem 0 0.25rem;
        }

        select, button {
            width: 100%;
            padding: 0.5rem;
            border-radius: 8px;
            border: 1px solid #ccc;
            margin-bottom: 1rem;
        }

        button {
            background-color: #ff5a1f;
            color: white;
            border: none;
            font-size: 1rem;
            cursor: pointer;
        }
    </style>
</head>
<body id="main-body">

<div class="form-container">
    <h2>Select Event and Theme</h2>
    <form method="POST" action="/select-theme">
        <label for="event">Event:</label>
        <select name="event" id="event">
            <option value="">-- Select Event --</option>
            <option value="diwali">Diwali</option>
            <option value="christmas">Christmas</option>
            <option value="birthday">Birthday</option>
        </select>

        <label for="theme">Theme:</label>
        <select name="theme" id="theme" required>
            <option value="">-- Select Theme --</option>
        </select>

        <button type="submit">Submit</button>
    </form>
</div>

<script>
    const eventSelect = document.getElementById('event');
    const themeSelect = document.getElementById('theme');
    const body = document.getElementById('main-body');

    const themesByEvent = {
        diwali: ['Lights', 'Traditional', 'Modern'],
        christmas: ['Snowy', 'Santa', 'Gifts'],
        birthday: ['Balloons', 'Minimal', 'Fun']
    };

    const backgroundImages = {
        Lights: '/static/images/diwali_lights.jpg',
        Traditional: 'diwali_traditional.jpeg',
        Modern: '/static/images/diwali_modern.jpg',
        Snowy: '/static/images/christmas_snowy.jpg',
        Santa: '/static/images/christmas_santa.jpg',
        Gifts: '/static/images/christmas_gifts.jpg',
        Balloons: '/static/images/birthday_balloons.jpg',
        Minimal: '/static/images/birthday_minimal.jpg',
        Fun: '/static/images/birthday_fun.jpg'
    };

    eventSelect.addEventListener('change', () => {
        const selectedEvent = eventSelect.value;
        themeSelect.innerHTML = '<option value="">-- Select Theme --</option>';
        if (themesByEvent[selectedEvent]) {
            themesByEvent[selectedEvent].forEach(theme => {
                const opt = document.createElement('option');
                opt.value = theme;
                opt.textContent = theme;
                themeSelect.appendChild(opt);
            });
        }
        // Reset background
        body.style.backgroundImage = '';
    });

    themeSelect.addEventListener('change', () => {
        const selectedTheme = themeSelect.value;
        if (backgroundImages[selectedTheme]) {
            body.style.backgroundImage = `url('${backgroundImages[selectedTheme]}')`;
        }
    });
</script>

</body>
</html>




@app.route('/select-theme', methods=['GET', 'POST'])
def select_theme():
    if request.method == 'POST':
        event = request.form.get('event')
        theme = request.form.get('theme')
        
        if event and theme:
            selection = ThemeSelection(event=event, theme=theme)
            db.session.add(selection)
            db.session.commit()
            return redirect(url_for('success', theme=theme))
        else:
            return render_template('select_theme.html', error="Please select both event and theme.")
    
    return render_template('select_theme.html')

@app.route('/success')
def success():
    theme = request.args.get('theme')
    return f"<h2>Theme '{theme}' successfully saved!</h2><a href='/select-theme'>Select Again</a>"
