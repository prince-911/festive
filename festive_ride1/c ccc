
@app.route('/register', methods=['GET', 'POST'])
def register():
    res = RegisterForm()

    if request.method=='POST':
        if res.validate_on_submit():

            role = res.userrole.data
            name = res.name.data
            gender = res.gender.data
            phone = res.phone.data
            email = res.email.data
            password = res.password.data

            if role == 'user':
                checkuser = user_register_form(role, name, gender, phone, email, password)
                checkadmin = admin_register_form(role, name, gender, phone, email, password)
                if checkuser == 0:
                    flash("User registered successfully")
                    return redirect(url_for('login'))
                elif checkuser == 1:
                    flash("User already exists")
                    return redirect(url_for('login'))
                elif checkadmin:
                    flash("Error: Admin credentials cannot be used as user")
                    return redirect(url_for('register'))
            elif role == 'admin':
                checkadmin = admin_register_form(role, name, gender, phone, email, password)
                checkuser = user_register_form(role, name, gender, phone, email, password)
                if checkadmin == 0:
                    flash("Admin registered successfully")
                    return redirect(url_for('login'))
                elif checkadmin == 1:
                    flash("Admin already exists")
                    return redirect(url_for('login'))
                elif checkuser:
                    flash("Error: User credentials cannot be used as Admin")
                    return redirect(url_for('register'))
                
        res.name.data=""
        res.gender.data=""
        res.phone.data=""
        res.email.data=""
        res.password.data=""

    elif request.method=='GET':
        #clear form on reload
        res.name.data=""
        res.gender.data=""
        res.phone.data=""
        res.email.data=""
        res.password.data=""
        res=RegisterForm()
    return render_template('register.html', res=res)
